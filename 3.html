<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome</title>
    <link rel="stylesheet" href="st.css">
</head>
<body>
    <div class="welcome">
        <h1 id="welcome-message" class="cur">Welcome To The Bank For Teens (BOT), <span id="username-display"></span></h1>
        <h2 class="cur curt"><em>A Bank where teenagers can store their money.</em></h2>
    </div>
    <div class="whiteMap">
        <table class="table-responsive o">
            <tbody>
                <tr>
                    <td class="first">
                        <h2 class="cur">Select your bank in which you have an account</h2>
                    </td>
                    <td class="second">
                        <div class="blue">
                            <!-- Bank Dropdown -->
                            <select id="bank" class="d">
                                <option>Select</option>
                                <option value="HDFC Bank">HDFC Bank</option>
                                <option value="ICICI Bank">ICICI Bank</option>
                                <!-- Add other banks here -->
                            </select>
                            <!-- Account Input Field -->
                            <input type="text" id="account" placeholder="Enter Account" class="d">
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="whiteMap">
        <table class="table-responsive h">
            <tbody>
                <tr>
                    <td class="first">
                        <h2 class="cur">Select your currency</h2>
                    </td>
                    <td class="second">
                        <div class="blue">
                            <!-- Currency Dropdown -->
                            <select id="currency" class="d">
                                <option>Select</option>
                                <option value="€">Euro (€)</option>
                                <option value="$">U.S. Dollar ($)</option>
                                <!-- Add other currencies here -->
                            </select>
                            <!-- Money Input Field -->
                            <input type="number" id="amount" placeholder="Enter Amount" class="d">
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <button class="btnnn" onclick="deposit()">Deposit</button>
    </div>

    <script>
        const username = localStorage.getItem('username');
        const email = localStorage.getItem('email');
        if (username) {
            document.getElementById('username-display').innerText = username;
        } else {
            alert('No user is logged in!');
            window.location.href = 'index.html';
        }

        function deposit() {
            const bank = document.getElementById('bank').value;
            const account = document.getElementById('account').value;
            const currency = document.getElementById('currency').value;
            const amount = document.getElementById('amount').value;

            if (bank === "Select" || currency === "Select" || !account || !amount) {
                alert("Please fill all fields correctly.");
                return;
            }

            // Retrieve user's balance from localStorage
            const userBalance = JSON.parse(localStorage.getItem('userBalance')) || {};

            // If user already exists, update their balance
            if (userBalance[email]) {
                const currentBalance = userBalance[email];
                if (currentBalance.currency === currency) {
                    // Add money if same currency
                    currentBalance.amount = parseFloat(currentBalance.amount) + parseFloat(amount);
                } else {
                    // Mention both currencies if different
                    currentBalance.amount = `${currentBalance.amount} ${currentBalance.currency} and ${amount} ${currency}`;
                    currentBalance.currency = `${currentBalance.currency} and ${currency}`;
                }
            } else {
                // Create new balance entry for the user
                userBalance[email] = {
                    bank,
                    account,
                    currency,
                    amount
                };
            }

            // Save updated user balance to localStorage
            localStorage.setItem('userBalance', JSON.stringify(userBalance));

            // Redirect to 4.html
            window.location.href = '4.html';
        }
    </script>
</body>
</html>
