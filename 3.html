<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to the Bank</title>
    <link rel="stylesheet" href="st.css">
</head>
<body>
    <div class="welcome">
        <h1 id="welcome-message" class="cur">Welcome To The Bank For Teens (BOT), <span id="username-display"></span></h1>
        <h2 class="cur curt"><em>A Bank where teenagers can store their money.</em></h2>
    </div>
    <div class="whiteMap">
        <table class="table-responsive o">
            <tbody>
                <tr>
                    <td class="first">
                        <h2 class="cur">Select your bank in which you have an account</h2>
                    </td>
                    <td class="second">
                        <div class="blue">
                            <!-- Bank Dropdown -->
                            <select id="bank" class="d">
                                <option>Select</option>
                                <option value="HDFC Bank">HDFC Bank</option>
                                <option value="ICICI Bank">ICICI Bank</option>
                                <option value="SBI">SBI (State Bank of India)</option>
                                <option value="Kotak Mahindra Bank">Kotak Mahindra Bank</option>
                                <option value="Punjab National Bank">Punjab National Bank</option>
                                <option value="Indian Overseas Bank">Indian Overseas Bank</option>
                                <option value="Bank of Baroda">Bank of Baroda</option>
                                <option value="Union Bank">Union Bank</option>
                                <option value="Canara Bank">Canara Bank</option>
                                <option value="Axis Bank">Axis Bank</option>
                            </select>
                            <!-- Account Input Field -->
                            <input type="text" id="account" placeholder="Enter Account" class="d">
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="whiteMap">
        <table class="table-responsive h">
            <tbody>
                <tr>
                    <td class="first">
                        <h2 class="cur">Select your currency</h2>
                    </td>
                    <td class="second">
                        <div class="blue">
                            <!-- Currency Dropdown -->
                            <select id="currency" class="d">
                                <option>Select</option>
                                <option value="€">Euro (€)</option>
                                <option value="$">U.S. Dollar ($)</option>
                                <option value="¥">Japanese Yen (¥)</option>
                                <option value="₹">Indian Rupee (₹)</option>
                                <option value="₣">Swiss Franc (₣)</option>
                                <option value="¥">Chinese Yuan (¥)</option>
                                <option value="CAN$">Canadian Dollar (CAN$)</option>
                                <option value="A$">Australian Dollar (A$)</option>
                                <option value="NZ$">New Zealand Dollar (NZ$)</option>
                            </select>
                            <!-- Money Input Field -->
                            <input type="number" id="amount" placeholder="Enter Amount" class="d">
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <button class="btnnn" onclick="deposit()">Deposit</button>
    </div>
    <script>
        // Retrieve the username and email from localStorage
        const username = localStorage.getItem('username');
        const email = localStorage.getItem('email');
        if (username && email) {
            document.getElementById('username-display').innerText = username;
        } else {
            alert('No user is logged in!');
            window.location.href = 'index.html';
        }

        // Function to handle deposit
        function deposit() {
            const bank = document.getElementById('bank').value;
            const account = document.getElementById('account').value;
            const currency = document.getElementById('currency').value;
            const amount = document.getElementById('amount').value;

            if (bank === "Select" || currency === "Select" || !account || !amount) {
                alert("Please fill all fields correctly.");
                return;
            }

            // Retrieve the user's balance from localStorage
            let userBalance = JSON.parse(localStorage.getItem('userBalance')) || {};

            // If the user's email doesn't have a balance record yet, initialize an empty array for their email
            if (!userBalance[email]) {
                userBalance[email] = [];
            }

            // Check if the currency already exists for the user
            let currencyExists = false;
            for (let i = 0; i < userBalance[email].length; i++) {
                if (userBalance[email][i].currency === currency) {
                    // If the currency exists, add the amount to the existing deposit
                    userBalance[email][i].amount = (parseFloat(userBalance[email][i].amount) + parseFloat(amount)).toString();
                    currencyExists = true;
                    break;
                }
            }

            // If currency doesn't exist for the user, create a new entry
            if (!currencyExists) {
                userBalance[email].push({ bank, account, currency, amount });
            }

            // Save the updated balance back to localStorage
            localStorage.setItem('userBalance', JSON.stringify(userBalance));

            // Redirect to 4.html to confirm the deposit
            window.location.href = '4.html';
        }
    </script>
</body>
</html>
